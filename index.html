<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Insane 2D Shooter</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden;
    background: #111; color: #0f0; user-select: none;
    font-family: monospace;
  }
  canvas {
    display: block;
    margin: auto;
    background: radial-gradient(circle at center, #333 0%, #000 100%);
  }
  #hud {
    position: fixed; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.7); color: #0f0;
    display: flex; justify-content: space-around;
    padding: 5px; font-size: 14px;
    font-family: monospace;
    z-index: 1000;
  }
  .hud-item {
    margin: 0 5px;
  }
  #score, #timer {
    position: fixed; top: 10px; font-size: 16px;
    text-shadow: 0 0 5px #0f0;
  }
  #score { left: 10px; }
  #timer { right: 10px; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="score">Score: 0</div>
<div id="timer">Time: 0s</div>
<div id="hud">
  <div class="hud-item" id="weapon-display">Weapon: Pistol</div>
  <div class="hud-item" id="ammo-display">Ammo: ∞</div>
  <div class="hud-item" id="grenade-display">Grenades: 0</div>
</div>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let W = canvas.width, H = canvas.height;

const keys = {};
const mouse = { x: W/2, y: H/2 };

window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);
window.addEventListener('mousemove', e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});
window.addEventListener('mousedown', () => keys['mouse'] = true);
window.addEventListener('mouseup', () => keys['mouse'] = false);

// --- Player ---
const player = {
  x: W/2, y: H/2, radius: 20,
  color: '#0f0', speed: 5,
  health: 100, maxHealth: 100,
  weapon: 'pistol', ammo: {
    pistol: Infinity,
    rifle: 32,
    smg: 50,
    sniper: 5,
    rpg: 1
  },
  clip: {
    pistol: Infinity,
    rifle: 32,
    smg: 50,
    sniper: 5,
    rpg: 1
  },
  maxClip: {
    rifle: 32,
    smg: 50,
    sniper: 5,
    rpg: 1
  },
  reloading: false,
  reloadTimer: 0,
  grenades: 0,
  hasKnife: true,
  hasShield: false,
  shieldHP: 0
};

let score = 0;
let elapsedTime = 0;

// --- Game Loop Setup ---
function gameLoop(timestamp) {
  ctx.clearRect(0, 0, W, H);
  updatePlayer();
  drawPlayer();
  updateUI();

  requestAnimationFrame(gameLoop);
}

function updatePlayer() {
  if (keys['w']) player.y -= player.speed;
  if (keys['s']) player.y += player.speed;
  if (keys['a']) player.x -= player.speed;
  if (keys['d']) player.x += player.speed;

  // Weapon switching
  if (keys['1']) player.weapon = 'pistol';
  if (keys['2'] && player.grenades > 0) player.weapon = 'grenade';
  if (keys['3']) player.weapon = 'rifle';
  if (keys['4'] && player.hasKnife) player.weapon = 'knife';
  if (keys['5'] && player.hasShield) player.weapon = 'shield';

  // Reloading
  if (keys['r'] && !player.reloading && player.weapon !== 'pistol') {
    const w = player.weapon;
    if (player.clip[w] < player.maxClip[w]) {
      player.reloading = true;
      let time = 60;
      if (w === 'smg') time = 30;
      if (w === 'sniper') time = 90;
      if (w === 'rpg') time = 120;
      player.reloadTimer = time;
    }
  }

  if (player.reloading) {
    player.reloadTimer--;
    if (player.reloadTimer <= 0) {
      const w = player.weapon;
      player.clip[w] = Math.min(player.ammo[w], player.maxClip[w]);
      player.reloading = false;
    }
  }

  // Shooting (placeholder)
  if (keys['mouse'] && !player.reloading) {
    const w = player.weapon;
    if (w !== 'pistol' && w !== 'knife' && w !== 'shield') {
      if (player.clip[w] > 0) {
        player.clip[w]--;
        score += 1; // placeholder for hitting enemies
      }
    }
  }
}

function drawPlayer() {
  ctx.fillStyle = player.color;
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
  ctx.fill();

  if (player.weapon === 'shield') {
    ctx.strokeStyle = '#ff0';
    ctx.lineWidth = 5;
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.radius + 10, 0, Math.PI * 2);
    ctx.stroke();
  }
}

function updateUI() {
  document.getElementById('score').innerText = `Score: ${score}`;
  document.getElementById('timer').innerText = `Time: ${Math.floor(elapsedTime / 60)}s`;
  document.getElementById('weapon-display').innerText = `Weapon: ${capitalize(player.weapon)}`;
  document.getElementById('grenade-display').innerText = `Grenades: ${player.grenades}`;

  let ammoText = '∞';
  if (player.weapon !== 'pistol' && player.weapon !== 'knife' && player.weapon !== 'shield' && player.weapon !== 'grenade') {
    ammoText = `${player.clip[player.weapon]} / ${player.ammo[player.weapon]}`;
  }
  document.getElementById('ammo-display').innerText = `Ammo: ${ammoText}`;
}

function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

requestAnimationFrame(gameLoop);
</script>
</body>
</html>
